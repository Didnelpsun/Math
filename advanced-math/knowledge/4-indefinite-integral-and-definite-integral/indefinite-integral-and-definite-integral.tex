\documentclass[UTF8, 12pt]{ctexart}
% UTF8编码，ctexart现实中文
\usepackage{color}
% 使用颜色
\definecolor{orange}{RGB}{255,127,0} 
\definecolor{violet}{RGB}{192,0,255} 
\definecolor{aqua}{RGB}{0,255,255} 
\usepackage{geometry}
\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}
% 设置四级目录与标题
\geometry{papersize={21cm,29.7cm}}
% 默认大小为A4
\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
% 默认页边距为1英尺与1.25英尺
\usepackage{indentfirst}
\setlength{\parindent}{2.45em}
% 首行缩进2个中文字符
\usepackage{setspace}
\renewcommand{\baselinestretch}{1.5}
% 1.5倍行距
\usepackage{amssymb}
% 因为所以
\usepackage{amsmath}
% 数学公式
\usepackage[colorlinks,linkcolor=black,urlcolor=blue]{hyperref}
% 超链接
\author{Didnelpsun}
\title{不定积分与定积分}
\date{}
\begin{document}
\maketitle
\pagestyle{empty}
\thispagestyle{empty}
\tableofcontents
\thispagestyle{empty}
\newpage
\pagestyle{plain}
\setcounter{page}{1}
\section{不定积分}

\subsection{定义}

设$f(x)$定义在区间$I$上，若存在可导函数$F(x)$，使得$F'(x)=f(x)$对于任意$x\in I$都成立，则称$F(x)$为$f(x)$在区间$I$上的一个原函数。

连续函数必有原函数。而反之有原函数不一定是连续函数。

任意的两个原函数只相差一个常数。

在区间$I$上，函数$f(x)$带有任意常数项的原函数$F(x)+C$称为$f(x)/f(x)\,\textrm{d}x$在该区间上的不定积分，记为$\int f(x)\,\textrm{d}x$，其中$\int$为积分号，$f(x)$为被积函数，$f(x)\,\textrm{d}x$为被积表达式，$x$为积分变量。

积分就是导数的逆运算。$\int f(x)\,\textrm{d}x=F(x)+C$，$F'(x)=f(x)$。 

\subsection{性质与积分运算}

积分运算就可以将原来求导的方式进行逆运算。其中隐函数求导法与参数方程求导法都可以看作复合函数求导法则的变式。

积分运算具有两个性质：

\begin{enumerate}
    \item $\int[f(x)+g(x)]\textrm{d}x=\int f(x)\textrm{d}x+\int g(x)\textrm{d}x$，就是分项积分法。
    \item $\int kf(x)\textrm{d}x=k\int f(x)\textrm{d}x$。
\end{enumerate}

复合函数的求导法则的逆运算，就是换元积分法。

函数乘积的求导法则的逆运算，就是分部积分法。

\subsection{换元积分法}

\subsubsection{第一类换元法（凑微分法）}

\textcolor{aqua}{\textbf{定理：}}$\int f(u)\,\textrm{d}u=F(u)+C$，则$\int f[\varphi(x)]\varphi'(x)\,\textrm{d}x=\int f[\varphi(x)]\,\textrm{d}\varphi(x)=F[\varphi(x)]+C$。

即用一个中间变量如$t$替换一个$x$的复杂表达式从而让式子更简单接近基本积分公式。

如$\displaystyle{\int\dfrac{x}{\sqrt{1+x^2}}\textrm{d}x=\dfrac{1}{2}\int\dfrac{\textrm{d}(1+x^2)}{\sqrt{1+x^2}}}=\sqrt{1+x^2}+C$。\medskip

凑微分法适用于式子比较简单的情况，所凑微分的形式必须符合一个简单积分公式的式子，且有一定的式子可以提出来到微分号后面。

\textbf{例题：}

$\int(1+3x)^{100}\,\textrm{d}x=\dfrac{1}{3}\int(1+3x)^{100}\,\textrm{d}(1+3x)=\dfrac{1}{303}(1+3x)^{101}+C$。

$\int\cos^2x\,\textrm{d}x=\dfrac{1}{2}\int(1+\cos 2x)\,\textrm{d}x=\dfrac{1}{2}\left(x+\dfrac{1}{2}\sin 2x\right)+C$。

$\int\cos^3x\,\textrm{d}x=\int\cos^2\,\textrm{d}\sin x=\int(1-\sin^2x)\,\textrm{d}\sin x=\sin x-\dfrac{1}{3}\sin^3x+C$。\medskip

$\displaystyle{\int\dfrac{\textrm{d}x}{x\sqrt{1+\ln x}}=\int\dfrac{\textrm{d}(1+\ln x)}{\sqrt{1+\ln x}}}=2\sqrt{1+\ln x}+C$。\medskip

$\displaystyle{\int\dfrac{\textrm{d}x}{\sqrt{x}(1+x)}=2\int\dfrac{\textrm{d}\sqrt{x}}{1+(\sqrt{x})^2}}=2\arctan\sqrt{x}+C$。\medskip

$\displaystyle{\int\dfrac{\arcsin\sqrt{x}}{\sqrt{x(1-x)}}\,\textrm{d}x=\int\dfrac{\arcsin\sqrt{x}}{1-x}\cdot\dfrac{\textrm{d}x}{\sqrt{x}}=2\int\dfrac{\arcsin\sqrt{x}}{1-(\sqrt{x})^2}\,\textrm{d}\sqrt{x}}$ \medskip

$=2\int\arcsin\sqrt{x}\,\textrm{d}\arcsin\sqrt{x}=(\arcsin\sqrt{x})^2+C$。\medskip

$\displaystyle{\int\dfrac{\textrm{d}x}{\sqrt{a^2-x^2}}}=\displaystyle{\int\dfrac{\textrm{d}\left(\dfrac{x}{a}\right)}{\sqrt{1-\left(\dfrac{x}{a}\right)^2}}}=\arcsin\dfrac{x}{a}+C$。

$\displaystyle{\int\dfrac{\textrm{d}x}{a^2+x^2}}=\displaystyle{\int\dfrac{\textrm{d}\left(\dfrac{x}{a}\right)}{1+\left(\dfrac{x}{a}\right)^2}}=\dfrac{1}{a}\arctan\dfrac{x}{a}+C$。\medskip

$\displaystyle{\int\dfrac{\textrm{d}x}{x^2-a^2}}=\displaystyle{\int\dfrac{\textrm{d}x}{(x-a)(x+a)}}=\dfrac{1}{2a}\displaystyle{\int\left(\dfrac{1}{x-a}-\dfrac{1}{x+a}\right)\textrm{d}x}$ \medskip

$=\dfrac{1}{2a}\left(\displaystyle{\int\dfrac{\textrm{d}(x-a)}{x-a}-\int\dfrac{\textrm{d}(x+a)}{x+a}}\right)=\dfrac{1}{2a}\ln\left\vert\dfrac{x-a}{x+a}\right\vert+C$。

\subsubsection{第二类换元法}

\textcolor{aqua}{\textbf{定理：}}设$x=\varphi(t)$为单调可导函数，且$\varphi'(t)\neq 0$，$\int f[\varphi(t)\varphi'(t)]\,\textrm{d}t=F(t)+C$，则$\int f(x)\textrm{d}x=\int f[\varphi(t)\varphi'(t)]\,\textrm{d}t=F(t)+C=F[\varphi^{-1}(x)]+C$。

第二类换元法适用于无法适用第一类换元法的情况，但是最重要的还是对于中间变量的取值，这个中间变量必须要让原式子更能接近公式，且还要注意到变量取值范围。

第二类换元法相当于第一类换元法的逆运算，不是将复杂的$x$表达式转为简单的一个$t$，而是将一个简单的$x$转换为一个关于$t$的表达式。这是因为简单的$x$无法求出积分结果，必须通过复杂化$x$“中和”一部分式子来进行转化。

\textcolor{orange}{注意：}$\varphi'(t)\neq 0$是为了保证中间变量函数具有反函数，而严格单调函数必然有反函数，所以只要能证明这个中间变量函数必然严格单调，那么其实$\varphi'(t)$也可以等于0。

\textbf{例题：}求$\int\sqrt{a^2-x^2}\,\textrm{d}x(a>0)$。

首先看题目，如果使用凑微分法，那必须从式子中提取出一个式子放到微分后面，且提取后的式子满足一个简单的积分公式。

这个式子一般就只能提取出$x$到平方号外面，但是提取后式子仍不能变为一个简单微分公式，所以说第一种凑微分法就无法使用，就只能使用第二类换元法。

这个式子是一个平方取开平方的式子，所以取中间变量后最好让这个式子能被开平方。又涉及到一个常数$a$，所以我们很容易就想到是否可以通过三角函数来作为中间变量。

所以取$x=a\sin t$，从而$\sqrt{a^2-x^2}=a\cos t$。

并且还要注意到这个$t$的取值范围。

因为$x=\varphi(t)$是一个单调可导的函数。所以$\sin t$必须取在单调区间上。

又$\sqrt{a^2-x^2}$要求$-a\leqslant x\leqslant a$，$-a\leqslant a\sin t\leqslant a$，从而$-1\leqslant\sin t\leqslant 1$。

且$\varphi'(t)\neq 0$，所以$\cos t\neq 0$。

所以综上三个条件从而得到一个$t$的定义域：$t\in\left[-\dfrac{\pi}{2},0\right)\cup\left(0,\dfrac{\pi}{2}\right]$。

但是在$\left[-\dfrac{\pi}{2},\dfrac{\pi}{2}\right]$上$\varphi'(t)=a\sin t$是严格单调递增的，单调函数必然存在反函数，所以$\varphi'(t)$可以等于0，从而$t\in\left[-\dfrac{\pi}{2},\dfrac{\pi}{2}\right]$。

$\int\sqrt{a^2-x^2}\,\textrm{d}x=a\int\cos t\,\textrm{d}a\sin t=a^2\int\cos^2t\textrm{d}t=\dfrac{a^2}{2}\int(1+\cos 2t)\textrm{d}t=\dfrac{a^2}{2}\left(t+\dfrac{1}{2}\sin 2t\right)+C=\dfrac{a^2}{2}\left(\arcsin\dfrac{x}{a}+\dfrac{x}{a}\sqrt{1-\dfrac{x^2}{a^2}}\right)+C$。

\textbf{例题：}

已知$\tan^2x+1=\sec^2x$。

$\displaystyle{\int\dfrac{\textrm{d}x}{\sqrt{a^2+x^2}}}(a>0)$。

令$x=a\tan t$。

原式$=\displaystyle{\int\dfrac{a\sec^2t}{a\sec t}\,\textrm{d}t=\int\sec t\,\textrm{d}t}=\ln\vert\sec t+\tan t\vert+C=\ln\bigg\vert\sqrt{1+\dfrac{x^2}{a^2}}+\dfrac{x}{a}\bigg\vert+C$。

$\displaystyle{\int\dfrac{\textrm{d}x}{\sqrt{x^2-a^2}}}(a>0)$。

令$x=a\sec t$。

原式$=\displaystyle{\int\dfrac{a\sec t\tan t}{a\tan t}\,\textrm{d}t}=\ln\bigg\vert\sec t+\tan t\bigg\vert+C=\ln\bigg\vert\dfrac{x}{a}+\sqrt{\dfrac{x^2}{a^2}-1}\vert+C$。\medskip

所以常用的换元积分替换方式：

\begin{enumerate}
    \item $\sqrt{a^2-x^2}$：$x=a\sin t(a\cos t)$。
    \item $\sqrt{a^2+x^2}$：$x=a\tan t$。
    \item $\sqrt{x^2-a^2}$：$x=a\sec t$。
\end{enumerate}

换元法本质是将式子转换为我们已知的积分公式，所以换元积分法只适合于能转换为积分公式的简单式子上，如果式子比较复杂或形式与大部分积分公式不一致，那么也无法换元了。

\subsection{分部积分法}

已知$(uv)'=uv'+u'v$，所以$uv'=(uv)'-u'v$，从而$\int uv'\,\textrm{d}x=\int(uv)'\,\textrm{d}x-\int vu'\,\textrm{d}x$，即$\int u\,\textrm{d}v=uv-\int v\,\textrm{d}u$。

所以分部积分法的公式就是：$\int u\,\textrm{d}v=uv-\int v\,\textrm{d}u$。

所以分部积分法的适用方式就是所求积分的式子是一个可拆分为两项不同函数的式子，式子的分式中一个式子不好积分，另一个式子好积分，就可以用好积分的式子来积分计算。

\subsubsection{基本分部积分}

\textbf{例题：}

$\int xe^x\,\textrm{d}x=\int x\,\textrm{d}e^x=xe^x-\int e^x\textrm{d}x=xe^x-e^x+C$。

$\int x\sin x\,\textrm{d}x=-\int x\,\textrm{d}\cos x=-[x\cos x-\int\cos x\,\textrm{d}x]=-[x\cos x-\sin x]+C=\sin x-x\cos x+C$。

$\int x\ln x\,\textrm{d}x=\dfrac{1}{2}\int\ln x\textrm{d}x^2=\dfrac{1}{2}[x^2\ln x-\ln x^2\textrm{d}\ln x]=\dfrac{1}{2}[x^2\ln x-\ln x\textrm{d}x]=\dfrac{1}{2}x^2\ln x-\dfrac{1}{4}x^2+C$。

$\int x\arctan x\textrm{d}x=\dfrac{1}{2}\int\arctan x\textrm{d}x^2=\dfrac{1}{2}\left[x^2\arctan x-\displaystyle{\int\dfrac{x^2}{1+x^2}\textrm{d}x}\right]=\\ \dfrac{1}{2}[x^2\arctan x-x+\arctan x]+C$。

\subsubsection{多次分部积分还原}

当式子中含有$\sin x$，$\cos x$，$e^x$这种积分后变化不大的因式时，可以适用多步分部积分，然后在右边计算的式子中得到左边目标式子一样的因式，然后移到一边就能得到目标式子的表达式。

\textbf{例题：}\medskip

$
\begin{aligned}
    \int e^x\sin x\,\textrm{d}x & =\int\sin x\,\textrm{d}e^x \\
    & =e^x\sin x-\int e^x\cos x\,\textrm{d}x \\
    & =e^x\sin x-\int\cos x\,\textrm{d}e^x \\
    & =e^x\sin x-\left[e^x\cos x+\int e^x\sin\,\textrm{d}x\right] \\
    2\int e^x\sin x\,\textrm{d}x & =e^x\sin x-e^x\cos x
\end{aligned}
$

$\therefore\int e^x\sin x\,\textrm{d}x=\dfrac{e^x\sin x-e^x\cos}{2}+C$。

$
\begin{aligned}
    \int\sec^3x\,\textrm{d}x =&\int\sec x\,\textrm{d}\tan x \\
    & =\sec x\tan x-\int\tan^2x\sec x\,\textrm{d}x \\
    & =\sec x\tan x-\int\sec^3x\textrm{d}x+\int\sec x\textrm{d}x \\
    2\int\sec^3x\,\textrm{d}x =&[\sec x\tan x+\ln\vert\sec x+\tan x\vert]
\end{aligned}
$

$\therefore\int\sec^3x\,\textrm{d}x =\dfrac{\sec x\tan x+\ln\vert\sec x+\tan x\vert}{2}+C$。

如上所说分部积分的方法就是找到目标式子中两个因式好求的一部分进行积分，其中好求是指$\textrm{d}v$微分后这个结果会简化整个式子。

其中$e^x$，$\sin x$，$\cos x$这三个因式求微分后无法简化，所以无法对其微分，除非需要多次分部积分还原间接求出；$x^n$微分后会降幂，所以一般可以积分；而$\ln x$，$\arctan x$，$\arcsin x$微分会转换为幂函数相关的式子降低幂次，如果不对其微分则无法消去这三个函数，所以如果出现这三个因式必然优先微分。

所以常用的分部积分方式：

\begin{enumerate}
    \item $\int x^ne^x\,\textrm{d}x$、$\int x^n\sin x\,\textrm{d}x$，$\int x^n\cos x\,\textrm{d}x$：对非幂函数的部分，即对$e^x$或三角函数进行分部。
    \item $\int x^n\ln x\,\textrm{d}x$，$\int x^n\arctan x\,\textrm{d}x$，$\int x^n\arcsin x\,\textrm{d}x$：对幂函数的部分，即对$x^n$进行分部。
    \item $\int e^x\sin x\,\textrm{d}x$，$\int e^x\cos x\,\textrm{d}x$：对哪个部分进行分部都可以，而$e^x$进行分部积分时没有正负号的改变，所以对$e^x$进行分部积分，需要多次分部积分还原。
\end{enumerate}

\subsection{有理函数的积分}

两个多项式的商$\dfrac{P(x)}{Q(x)}$被称为有理函数，或有理分式。

假设该多项式之间没有公因式，当$P(x)$的次数小于$Q(x)$的次数时村各位真分式，否则称为假分式。

假分式可以分解为多项式与真分式之和。

真分式$\dfrac{P(x)}{Q(x)}$若可以分解为两个多项式的乘积：$\dfrac{P(x)}{Q(x)}=\dfrac{P_1(x)}{Q_1(x)}+\dfrac{P_2(x)}{Q_2(x)}$，则称为将真分式化为部分分式之和。

通过这种化简方式，可以在求以商的形式的有利函数的式子的积分时拆分因式，从而简化积分运算。

\section{定积分}

定积分是积分的一种，是函数在一个区间上积分和的极限。已知$f(x)$为速度函数，则$f'(x)$为速度变化率函数，$\textrm{d}f(x)$为瞬时位移，则$\int_{a}^bf(x)\,\textrm{d}x$为位移函数。

\subsection{定义}

设函数$f(x)$在区间$[a,b]$上连续，将区间分割为$n$个子区间：$[x_0,x_1],(x_1,x_2],$\\$(x_2,x_3],\cdots,(x_{n-1},x_n]$，其中$x_0=a$，$x_n=b$。并可知各区间长度为$\Delta x_1=x_1-x_0\cdots$，在每个子区间$(x_{i-1},x_i]$上任意取一点$\xi_i(i=1,2,\cdots,n)$，做累计和$\sum\limits_{i=1}^nf(\xi_i)\Delta x_i$，这个式子被称为积分和。

设$\lambda=\max{\Delta x_1,\Delta x_2,\cdots,\Delta x_n}$，从而$\lambda$为最大的区间长度，若$\lambda\to 0$时积分和极限存在，则这个极限就是函数在区间$[a,b]$的定积分，记为$\int_a^bf(x)\,\textrm{d}x$，并称函数$f(x)$在区间$[a,b]$上可积。

其中$a$为积分下限，$b$为积分上限，区间$[a,b]$为积分区间，函数$f(x)$为被积函数，$x$是积分变量，$f(x)\,\textrm{d}x$为被积表达式，$\int$为积分号。

\subsection{性质}

设函数$f(x)$在区间$[a,b]$上连续，则：

\begin{enumerate}
    \item 当$a=b$时，$\int_a^bf(x)\,\textrm{d}x=0$。
    \item 当$a>b$时，$\int_a^bf(x)\,\textrm{d}x=-\int_b^af(x)\,\textrm{d}x$。
    \item $\int_a^bkf(x)\,\textrm{d}x=k\int_a^bf(x)\,\textrm{d}x$。
    \item $\int_a^b[f(x)\pm g(x)]\,\textrm{d}x=\int_a^bf(x)\,\textrm{d}x\pm\int_a^bg(x)\,\textrm{d}x$。
    \item $\int_a^bf(x)\,\textrm{d}x=\int_a^cf(x)\,\textrm{d}x+\int_c^bf(x)\,\textrm{d}x$，若$c$处于函数的可积区间。
    \item 若$[a,b]$上$f(x)\geqslant 0$，则$\int_a^bf(x)\,\textrm{d}x\geqslant 0$。
    \item 若$[a,b]$上$f(x)\leqslant g(x)$，则$\int_a^bf(x)\,\textrm{d}x\leqslant\int_a^bg(x)\,\textrm{d}x$。
    \item 积分中值定理：$\exists\,\varepsilon\in[a,b]$，使得$\int_a^bf(x)\,\textrm{d}x=f(\varepsilon)(b-a)$。
\end{enumerate}

证明积分中值定理：

设函数$f(x)$在区间$[a,b]$上连续，因为闭区间上连续函数必然有最大最小值，所以设最大值为$M$，最小值为$m$，$M\geqslant m$。

对$m\leqslant f(x)\leqslant M$两边积分得到：$m(b-a)\leqslant\int_a^bf(x)\,\textrm{d}x\leqslant M(b-a)$。

同时除以$b-a$得到：$m\leqslant\dfrac{1}{b-a}\int_a^bf(x)\,\textrm{d}x\leqslant M$。

由连续函数的介值定理，必然存在一个$\varepsilon$，使得$f(\varepsilon)=\dfrac{1}{b-a}\int_a^bf(x)\,\textrm{d}x$。

从而得到$\exists\,\varepsilon\in[a,b]$，使得$\int_a^bf(x)\,\textrm{d}x=f(\varepsilon)(b-a)$。

对于定积分的存在性：

\textcolor{aqua}{\textbf{定理：}}设函数$f(x)$在区间$[a,b]$上连续，则$f(x)$在该区间上可积。

\textcolor{aqua}{\textbf{定理：}}设函数$f(x)$在区间$[a,b]$上有界，且只有有限个间断点，则$f(x)$在该区间上可积。

\subsection{变限积分}

设$f(x)$在$[a,b]$上连续，且$\Phi(x)=\int_a^xf(t)\,\textrm{d}t(x\in[a,b])$，这个函数就是积分上限函数或叫积分变限函数。

\textcolor{aqua}{\textbf{定理：}}设$f(x)$在$[a,b]$上连续，则$\int_a^xf(t)\,\textrm{d}t$在$[a,b]$上$(\int_a^xf(t)\,\textrm{d}t)'=f(x)$。

证明：设$x\in(a,b)$。

则$\dfrac{\Phi(x+\Delta x)-\Phi(x)}{\Delta x}=\dfrac{\int_a^{x+\Delta x}f(t)\,\textrm{d}t-\int_a^xf(t)\,\textrm{d}t}{\Delta x}=\dfrac{\int_x^{x+\Delta x}f(t)\,\textrm{d}t}{\Delta x}$。

由积分中值定理存在$\xi$使得原式$=\dfrac{\Delta x\,f(\xi)}{\Delta x}=f(\xi)$。

从而$\Phi'(x)=\lim\limits_{\Delta x\to 0}\dfrac{\Phi(x+\Delta x)-\Phi(x)}{\Delta x}=f(x)$。

同理当$x=a,\Delta x>0$与$x=b,\Delta x<0$时也同样成立。

\textbf{例题：}求$F(x)=\int_0^{x^2}e^{-t^2}\,\textrm{d}t$的导数。

由定理，可以将式子看作复合函数求导（注意定理中积分上限为$x$，而这里不是$x$，但是对$x$求导，所以必须看作为一个复合函数求导）。

$F(x)=\int_0^ue^{-t^2}\,\textrm{d}t$，$u=x^2$。

$\therefore F'_x(x)=F'_u(x)\cdot u'_x=e^{-u^2}\cdot 2x=2xe^{-x^4}$。

同理，如果是变下限的变限积分，则可以看作负的变上限积分进行运算，本质是一样的。

也同理，如果上限下限都在变化，则可以利用积分区间的可加性，将这个积分的区间插入一个常数（一般为0），将一个积分式子变为两个积分式子，再分别进行运算。

所以变限积分\textcolor{aqua}{\textbf{定理：}}若$\phi(x)$与$\psi(x)$都可导，$f(x)$连续，则$\dfrac{\textrm{d}}{\textrm{d}x}\int_{\psi(x)}^{\phi(x)}=f(\psi(x))\psi'(x)-f(\phi(x))\phi'(x)$。

\textbf{例题：}求极限$\lim\limits_{x\to 0}\dfrac{\int_0^{\sin^2x}\ln(1+t)\,\textrm{d}t}{x(\sqrt{1+x^3}-1)}$。

原式$=\lim\limits_{x\to 0}\dfrac{\ln(1+\sin^2x)2\sin x\cos x}{x(\sqrt{1+x^3}-1)}=\lim\limits_{x\to 0}\dfrac{x^2\cdot 2x\cdot 1}{\dfrac{4}{3}x^3}=\dfrac{3}{2}$。\smallskip

\textcolor{aqua}{\textbf{定理：}}设$f(x)$在$[a,b]$上连续，则$\int_a^xf(t)\,\textrm{d}t$是$f(x)$在$[a,b]$上的一个原函数。

\subsection{牛顿-莱布尼茨公式}

\textcolor{aqua}{\textbf{定理：}}（微积分基本定理/牛顿-莱布尼茨公式）若函数$F(x)$是连续函数$f(x)$在区间$[a,b]$上的一个原函数，则$\int_a^bf(x)\,\textrm{d}x=F(b)-F(a)$。

利用牛莱公式证明积分中值定理：

已知$F'(x)=f(x)$。

$\int_a^bf(x)\,\textrm{d}x=F(b)-F(a)=F'(\xi)(b-a)=f(\xi)(b-a)(a<\xi b)$。

牛-莱公式连接了微分学和积分学之间的关系。

\subsection{换元积分法与分部积分法}

定积分的换元积分法与分部积分法就是在定积分的换元积分法与分部积分法上代入了牛-莱公式。

\subsubsection{换元积分法}

\textcolor{aqua}{\textbf{定理：}}设$f(x)$在$[a,b]$上连续，函数$x=\varphi(t)$满足(1)$\varphi(\alpha)=a,\varphi(\beta)=b$，(2)$\varphi(t)$在$[\alpha,\beta]$上具有连续导数，且其值域$R_\varphi=[a,b]$，则有$\int_a^bf(x)\,\textrm{d}x=\int_\alpha^\beta f[\varphi(t)]\varphi'(t)\,\textrm{d}t$。

\subsubsection{分部积分法}

\textcolor{aqua}{\textbf{定理：}}$\int_a^bu\,\textrm{d}v=[uv]_a^b-\int_a^bv\,\textrm{d}u$。

\subsection{反常积分}

当积分区间为无穷区间，或被积函数为无界函数，那么定积分就无法“定”下来，所以这种积分就是反常积分。

\subsubsection{无穷限}

设函数$f(x)$在区间$[a,+\infty)$上连续，任取$t>a$，做定积分$\int_a^tf(x)\,\textrm{d}x$，对这种变上限积分的极限$\lim\limits_{t\to+\infty}\int_a^tf(x)\,\textrm{d}x$就是$f(x)$在无穷区间$[a,+\infty)$上的反常积分，记为$\int_a^{+\infty}f(x)\,\textrm{d}x$。

\textcolor{violet}{\textbf{定义：}}若函数$f(x)$在区间$[a,+\infty)$上连续，且极限$\lim\limits_{t\to+\infty}\int_a^tf(x)\,\textrm{d}x$存在，则称反常积分$\int_a^{+\infty}f(x)\,\textrm{d}x$收敛，且这极限就是该反常积分的值，若该极限不存在，则反常积分$\int_a^{+\infty}f(x)\,\textrm{d}x$发散。

同理可以给出定义$\int_{-\infty}^af(x)\,\textrm{d}x=\lim\limits_{t\to-\infty}\int_t^af(x)\,\textrm{d}x$。

无穷限反常积分$\int_{-\infty}^{+\infty}f(x)\,\textrm{d}x=\int_{-\infty}^0f(x)\,\textrm{d}x+\int_0^{+\infty}f(x)\,\textrm{d}x$。

\subsubsection{无界函数}

若$f(x)$在点$a$的任意一个邻域内都无界，则$a$就是$f(x)$的瑕点（无界间断点），无界函数的反常积分又称为瑕积分。

设$f(x)$在区间$(a,b]$上连续，点$a$为$f(x)$的瑕点，任取$t>a$，作定积分$\int_t^bf(x)\,\textrm{d}x$，则对变下限的定积分求极限的$\lim\limits_{t\to a^+}\int_t^bf(x)\,\textrm{d}x$就是函数$f(x)$在区间$(a,b]$上的反常积分，记为$\int_a^bf(x)\,\textrm{d}x$。

\textcolor{violet}{\textbf{定义：}}若$f(x)$在区间$(a,b]$上连续，$a$为$f(x)$的瑕点，若极限$\lim\limits_{t\to a^+}\int_t^bf(x)\,\textrm{d}x$存在，则称反常积分$\int_a^bf(x)\,\textrm{d}x$收敛，并称为此极限为该反常积分的值，若不存在，则反常积分$\int_a^bf(x)\,\textrm{d}x$发散。

同理可得$\int_a^bf(x)\,\textrm{d}x=\lim\limits_{t\to b^-}\int_a^tf(x)\,\textrm{d}x$

若$f(x)$在区间$[a,c)\cup(c,b]$上连续，$c$为瑕点，则$\int_a^bf(x)\,\textrm{d}x=\int_a^cf(x)\,\textrm{d}x+\int_c^bf(x)\,\textrm{d}x$。

\subsection{反常积分的判敛}

\subsection{不定积分与定积分的区别与联系}

区别：

不定积分最后结果是一类函数的集合；定积分的结果是一个数，或是关于积分上下限的二元函数或运算。

不定积分概念建立于原函数上，定积分的概念建立于求曲边图形面积上。

一个函数，可以存在不定积分，而不存在定积分，也可以存在定积分，而没有不定积分。连续函数，一定存在定积分和不定积分；若在有限区间$[a,b]$上只有有限个间断点且函数有界，则定积分存在；若有跳跃、可去、无穷间断点，则原函数一定不存在，即不定积分一定不存在。

联系：

定积分的计算建立于不定积分。且方法都是类似的。

可以通过牛-莱公式转换定积分与不定积分。

\section{定积分应用}

对比不定积分的直接数学计算，定积分的实际应用要广许多，往往可以用来解决几何、物理等问题。

对于定积分概念的引入就是对求面积采用元素法，即将曲边多边形无限次的分割得到每一片的平均值再求和得到近似解。

元素法也叫微元法，是分析、解决物理问题中的常用方法，也是从部分到整体的思维方法。用该方法可以使一些复杂的物理过程用我们熟悉的物理规律迅速地加以解决，使所求的问题简单化。在使用元素法处理问题时，需将其分解为众多微小的“元过程”，而且每个“元过程”所遵循的规律是相同的，这样，我们只需分析这些“元过程”，然后再将“元过程”进行必要的数学方法或物理思想处理，进而使问题求解。

\subsection{几何应用}

\subsubsection{面积}

\paragraph{直角坐标系}  \leavevmode \medskip

\textbf{例题：}求曲线$y^2=x$与$y=x^2$所围成面积。

首先确定$x$的范围，是$x\in[0,1]$。

第二步确立微元，即切割的微小元素，是$\textrm{d}S=[\sqrt{x}-x^2]\textrm{d}x$（也可以对$y$积分：$S=\int_0^1(\sqrt{y}-y^2)\,\textrm{d}y$）。

最后一步对其积分：$S=\int_0^1(\sqrt{x}-x^2)\,\textrm{d}x=\dfrac{2}{3}-\dfrac{1}{3}=\dfrac{1}{3}$。

\textbf{例题：}求曲线$y^2=2x$与$y=x-4$围成面积。

首先确定范围，将$y=x-4$代入$y^2=2x$，从而得到$x\in[0,8]$，$y\in[-2,4]$。

若是对$x$确立微元，则对于不同的区间，面积有不同的表达式：

$S=\int_0^22\sqrt{2x}\,\textrm{d}x+\int_2^8(\sqrt{2x}-x+4)\,\textrm{d}x$。

这显然很麻烦，然而如果对$y$确立微元，那么$y^2=2x$在$y\in[-2,4]$上总是在$y=x-4$下面，所以这个面积只要一个表达式就能表达出来：

$\textrm{d}S=\left[(y+4)-\dfrac{y^2}{2}\right]\textrm{d}y$。

所以$S=\displaystyle{\int_{-2}^4\left[(y+4)-\dfrac{y^2}{2}\right]\textrm{d}y}$

\paragraph{参数方程}  \leavevmode \medskip

\textbf{例题：}求摆线一拱$\left\{\begin{array}{l}
    x=a(t-\sin t) \\
    y=a(1-\cos t)
\end{array}
\right.$$(0\leqslant t\leqslant 2\pi)$与$x$轴所围成的面积。\medskip

首先计算范围，代入$2\pi$，得到$x\in[0,2a\pi]$。

然后是找微元，这里是对$x$确立：$\textrm{d}S=y(x)\,\textrm{d}x$。

从而$S=\int_0^{2a\pi}y(x)\,\textrm{d}x$。

因为无法计算对于$x$的表达式，所以使用参数方程代入，并改变上下限$S$：

$=\int_0^{2\pi}a(1-\cos t)\,\textrm{d}[a(t-\sin t)]$

$=\int_0^{2\pi}a^2(1-\cos t)^2\,\textrm{d}t$

$=a^2\displaystyle{\int_0^{2\pi}\left(2\sin^2\dfrac{t}{2}\right)^2\textrm{d}t}$（消去里面的1）

$=4a^2\displaystyle{\int_0^{2\pi}\sin^4\dfrac{t}{2}\,\textrm{d}t}$

令$u=\dfrac{t}{2}$，从而$\textrm{d}t=2\textrm{d}u$，从而$u\in[0,\pi]$。

$=8a^2\int_0^\pi\sin^4u\,\textrm{d}u$

$=16a^2\int_0^{\frac{\pi}{2}}\sin^4u\,\textrm{d}u$（积分可加性拆分为两个相同限的项）

$=16a^2\cdot\dfrac{3}{4}\cdot\dfrac{1}{2}\cdot\dfrac{\pi}{2}=3a^2\pi$（点火公式）。

\paragraph{极坐标}  \leavevmode \medskip

已知极径函数$\rho=\rho(\theta)$，极角$\theta\in[\alpha,\beta]$，极坐标所围成面积就是初始角所在射线与结束角所在射线以及函数所围成的图形。所以微元计算时所围成的图形可以近似看作扇形。

从而根据扇形公式得到微元：$\textrm{d}S=\dfrac{1}{2}\rho^2(\theta)\,\textrm{d}\theta$。

最后$S=\dfrac{1}{2}\int_\alpha^\beta\rho^2(\theta)\,\textrm{d}\theta$。

\textbf{例题：}求心形线$\rho=a(1+\cos\theta)(a>0)$所围成面积。

极角发生变化时，可以计算到心形线必然会穿过$(2a,0),(0,a),(0,0)$这三个点，而$\cos x$是一个偶函数，所以心形线图形是上下对称的。如果要求心形线的面积，可以只用求上半部分就可以了。

所以可以根据公式$S=2\dfrac{1}{2}\int_0^\pi a^2(1+\cos\theta)^2\,\textrm{d}\theta$。

$=a^2\displaystyle{\int_0^\pi\left(2\cos^2\dfrac{\theta}{2}\right)^2\textrm{d}\theta}$

$=4a^2\displaystyle{\int_0^\pi\cos^4\dfrac{\theta}{2}\,\textrm{d}\theta}$

令$\dfrac{\theta}{2}=t$，所以$\textrm{d}\theta=2\textrm{d}t$，同时上下限缩小一半：

$=8a^2\int_0^{\frac{\pi}{2}}\cos^4t\,\textrm{d}t$

根据华理士公式：$=8a^2\cdot\dfrac{3}{4}\cdot\dfrac{1}{2}\cdot\dfrac{\pi}{2}=\dfrac{3}{2}a^2\pi$。

\subsubsection{体积}

\paragraph{旋转体}  \leavevmode \medskip

当绕$x$轴进行旋转，可以看作从$x$轴沿$y$轴水平切割旋转体，就得到了以$x$轴为中心的一个圆柱，底边半径为$f(x)$，高度为$\textrm{d}x$，所以$\textrm{d}V_x=\pi f^2(x)\,\textrm{d}x$，所以$V_x=\pi\int_a^bf^2(x)\,\textrm{d}x$（如果用$y(x)$表达，就是$V_x=\pi\int_c^d\varphi^2(y)\,\textrm{d}y$）。

当绕$y$轴进行旋转，可以看作从旋转中心向外围按同样的半径切割环形体，这个环形体从里到外半径与体积都在不断变大，然后将这个环形体展开为长方体来计算体积，其中长度为原来圆周$2\pi x$，宽度为$f(x)$，高度为$\textrm{d}x$，所以$\textrm{d}V_y=2\pi xf(x)\,\textrm{d}x$，所以$V_y=2\pi\int_a^bxf(x)\,\textrm{d}x$。

\textbf{例题：}计算由椭圆$\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}=1$所围成的图形绕$x$轴旋转一周而成的体积。

由式子得到$y^2=b^2\left(1-\dfrac{x^2}{b^2}\right)$。

所以旋转体体积就是两倍的第一象限的旋转体积，直接计算第一象限部分就可以了。

$V_x=2\pi\displaystyle{\int_0^ab^2\left(1-\dfrac{x^2}{a^2}\right)\,\textrm{d}x}=2\pi b^2\left(a-\dfrac{a}{3}\right)=\dfrac{4\pi ab^2}{3}$。

\textbf{例题：}计算摆线$\left\{\begin{array}{l}
    x=a(t-\sin t) \\
    y=a(1-\cos t)
\end{array}
\right.$$(0\leqslant t\leqslant 2\pi)$与$x$轴，$y$轴所旋转得到的体积。

$\because t\in[0,2\pi]$，$\therefore x\in[0,2a\pi]$。

$V_x=\pi\int_0^{2a\pi}y^2\,\textrm{d}x$

代入参数方程并改变上下限：

$=\pi\int_0^{2\pi}a^2(1-\cos t)^2\,\textrm{d}[a(t-\sin t)]$

$=a^3\pi\int_0^{2\pi}(1-\cos t)^3\,\textrm{d}t$

$=a^3\pi\displaystyle{\int_0^{2\pi}\left(2\sin^2\dfrac{t}{2}\right)^3\textrm{d}t}$

$=8a^3\pi\displaystyle{\int_0^{2\pi}\sin^6\dfrac{t}{2}\textrm{d}t}$

令$\dfrac{\theta}{2}=t$，所以$\textrm{d}\theta=2\textrm{d}t$，同时上下限缩小一半：

$=16a^3\pi\int_0^\pi\sin^6u\,\textrm{d}u$

$=32a^3\pi\int_0^{\frac{\pi}{2}}\sin^6u\,\textrm{d}u$

华理士公式得到最后$=5a^3\pi^2$。

同理可得$y$轴旋转体积为$V_y=2\pi\int_0^{2\pi}xy(x)\,\textrm{d}x$

$=2\pi\int_0^{2\pi}a(t-\sin t)a^2(1-\cos t)^2\,\textrm{d}t$

$=2a^3\pi\int_0^{2\pi}(t-\sin t)\cdot 4\sin^4\dfrac{t}{2}\,\textrm{d}t$

然后拆开分别进行凑微分法，得到$6a^3\pi^3$。

\paragraph{平行截面已知的立体体积}  \leavevmode \medskip

已知截面面积可以通过对应的高得到立体体积：$V=\int_a^bS(x)\,\textrm{d}x$。

\textbf{例题：}计算由$\dfrac{x^2}{a^2}+\dfrac{y^2}{b^2}+\dfrac{z^2}{c^2}=1$所围成的椭球体的体积。

已知$\dfrac{y^2}{b^2}+\dfrac{z^2}{c^2}=1-\dfrac{x^2}{a^2}$.

$S(x)=\pi bc\left(1-\dfrac{x^2}{a^2}\right)$

$V=2\int_0^a\pi bc\left(1-\dfrac{x^2}{a^2}\right)\,\textrm{d}x$。

解得$V=\dfrac{4}{3}\pi abc$。

\subsubsection{弧长}

在弧长中插入$n$个点$M_1,M_2,\cdots,M_{i-1},M_i,\cdots,M_n$。

$S_n=\sum\limits_{i=1}^n\Vert\overline{M_{i-1}M_{i}}\Vert$，$S=\lim\limits_{\delta\to 0}S_n=\lim\limits_{\delta\to 0}\sum\limits_{i=1}^n\Vert\overline{M_{i-1}M_{i}}\Vert$。

对于弧长采用弧微分的方式进行计算：$S=\int_a^b\sqrt{1+y'^2}\,\textrm{d}x$。

如果是参数方程，则$S=\int_\alpha^\beta\sqrt{x'^2+y'^2}\,\textrm{d}t$。

如果是极坐标方程，则$S=\int_\alpha^\beta\sqrt{\rho^2+\rho'^2}\,\textrm{d}\theta$。



\end{document}
